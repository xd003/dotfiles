#!/usr/bin/env bash

RES=$(xrandr -q | sed '3q;d' | perl -pe 's|^\s{3}(\w+)\s+(\d+).*|$1|g')
RATE=$(xrandr -q | sed '3q;d' | perl -pe 's|^\s{3}(\w+)\s+(\d+).*|$2|g')

ffmpeg -f x11grab \
-framerate $RATE \
-video_size $RES \
-i $DISPLAY \
-preset ultrafast \
-vaapi_device /dev/dri/renderD128 \
-c:v h264_vaapi \
$HOME/Videos/"$(date +%Y%m%d_%H%M%S)".mp4
